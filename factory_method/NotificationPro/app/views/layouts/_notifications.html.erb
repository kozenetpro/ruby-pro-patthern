<div data-controller="notifications" class="relative">
  <button type="button" data-action="notifications#toggle" class="size-[38px] relative inline-flex justify-center items-center gap-x-2 text-sm font-semibold rounded-full border border-transparent text-gray-800 hover:bg-gray-100 focus:outline-none focus:bg-gray-100 disabled:opacity-50 disabled:pointer-events-none">
    <svg class="shrink-0 size-4" xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
      <path d="M6 8a6 6 0 0 1 12 0c0 7 3 9 3 9H3s3-2 3-9"/>
      <path d="M10.3 21a1.94 1.94 0 0 0 3.4 0"/>
    </svg>
    <span class="sr-only">Notifications</span>
    <span data-notifications-target="newIcon" class="hidden text-red-500 text-lg font-bold">+</span>
  </button>
  
  <div data-notifications-target="menu" class="hidden absolute right-0 mt-2 w-80 bg-white shadow-lg rounded-lg p-4 max-h-96 overflow-y-auto">
    <div class="ps-2 my-2 first:mt-0">
      <h3 class="text-xs font-medium uppercase text-gray-500">
        Notifications
      </h3>
    </div>
    <% if @notifications.empty? %>
      <div class="flex flex-col items-center justify-center gap-y-2">
        <img class="size-20" src="https://via.placeholder.com/80" alt="Empty State">
        <p class="text-sm text-gray-600 text-center">
          No notifications yet.
        </p>
      </div>
    <% else %>
      <div class="divide-y divide-gray-200">
        <% @notifications.reverse_each do |notification| %>
          <div class="flex gap-x-3 mb-4">
            <div class="relative last:after:hidden after:absolute after:top-7 after:bottom-0 after:start-3.5 after:w-px after:-translate-x-[0.5px] after:bg-gray-200">
              <div class="relative z-10 size-7 flex justify-center items-center">
                <div class="size-2 rounded-full bg-gray-400"></div>
              </div>
            </div>
            <div class="grow pt-0.5 pb-8">
              <h3 class="flex gap-x-1.5 font-semibold text-gray-800">
                <%= notification.notification_type.capitalize %> Notification
              </h3>
              <p class="mt-1 text-sm text-gray-600">
                <%= truncate(notification.message, length: 30) %>
              </p>
              <button type="button" class="mt-1 -ms-1 p-1 inline-flex items-center gap-x-2 text-xs rounded-lg border border-transparent text-gray-500 hover:bg-gray-100 focus:outline-none focus:bg-gray-100 disabled:opacity-50 disabled:pointer-events-none">
                <img class="shrink-0 size-4 rounded-full" src="https://via.placeholder.com/40" alt="Avatar">
                <%= @user.name %>
              </button>
            </div>
          </div>
        <% end %>
      </div>
    <% end %>
  </div>
</div>